#include "user_fgm_mpc.h"
#include "math.h"
//#include "mex.h"

void fgm_mpc(d_fgm x_hat[n_states], d_fgm u_opt[n_opt_var])
{
	 int i,j,k;

	 //data arrays
	d_fgm H_diff_negative[40][40] = {-0.9591447919594884,0.0198210534856012,0.0008377183957642,0.0005620136072849,0.0003796242856754,0.0003181209097839,0.0000699866001525,0.0000530201516306,0.0000381745091741,0.0000254496727827,0.0125106349787675,0.0038937999357547,0.0001696644852181,0.0006553290741548,0.0003329665522405,0.0002629799520880,0.0000466577334350,0.0000318120909784,0.0000212080606523,0.0000106040303261,-0.0036541488503842,-0.0046869814041492,0.0002481343096314,0.0006828995530027,0.0002672215642185,0.0001972349640660,0.0000296912849132,0.0000169664485218,0.0000084832242609,0.0000042416121305,-0.0070940962881806,-0.0052532366235645,0.0003117584915882,0.0004686981404149,0.0001696644852181,0.0001145235275222,0.0000148456424566,0.0000063624181957,0.0000021208060652,-0.0000000000000000,0.0198210534856012,-0.9584428051518987,0.0075712776528564,0.0042606993850388,0.0017348193613548,0.0012873292815921,0.0002735839824141,0.0002014765761965,0.0001505772306310,0.0000996778850656,0.0135392259204021,0.0184913080827045,0.0047612096164321,0.0033996521225571,0.0013276245968314,0.0009882956263953,0.0001802685155442,0.0001230067517831,0.0000848322426090,0.0000487785395002,0.0039871154026247,0.0040783100634294,0.0031048600794907,0.0026319203269453,0.0009734499839387,0.0007168324500464,0.0001124027214570,0.0000678657940872,0.0000402953152393,0.0000212080606523,-0.0025831417874451,-0.0027040277331630,0.0016563495369414,0.0015503092336801,0.0005917048921980,0.0004071947645234,0.0000572617637611,0.0000296912849132,0.0000148456424566,0.0000063624181957,0.0008377183957642,0.0075712776528564,-0.9825945446226911,0.0117386615710253,0.0055968072061311,0.0045851827130184,0.0011219064085045,0.0008971009655906,0.0007210740621768,0.0005195974859803,0.0024813430963143,0.0079190898475535,0.0109857754178701,0.0090494794803189,0.0045003504704093,0.0037644307657760,0.0007995438865902,0.0006001881164589,0.0004496108858279,0.0002947920430664,0.0032787661768392,0.0069477606696800,0.0060718677647417,0.0063200020743732,0.0033699608376439,0.0028079472303591,0.0005429263526978,0.0003690202553493,0.0002544967278271,0.0001526980366963,0.0022671416837265,0.0040973973180164,0.0022289671745524,0.0032405916676652,0.0020105241498341,0.0015566716518758,0.0003032752673273,0.0001823893216094,0.0001166443335874,0.0000721074062177,0.0005620136072849,0.0042606993850388,0.0117386615710253,-0.9790803689726119,0.0122328093842229,0.0106209967746513,0.0029776117155771,0.0025428464722058,0.0022056383078349,0.0017433025856157,0.0010285909416346,0.0040040818511465,0.0084811034548383,0.0124894269181153,0.0091852110684933,0.0084089960486207,0.0022565376534003,0.0018705509495292,0.0015587924579410,0.0011515976934177,0.0014612353789406,0.0036011286987536,0.0055480286666309,0.0067335592570922,0.0064239215715692,0.0058788744128062,0.0016457455066153,0.0012809668633964,0.0010222285234389,0.0007337988985682,0.0011961346207874,0.0023986316597705,0.0026764572543151,0.0023816652112487,0.0034675179166443,0.0029776117155771,0.0009501211172212,0.0006892619711984,0.0005323223223717,0.0004220404069800,0.0003796242856754,0.0017348193613548,0.0055968072061311,0.0122328093842229,-0.9502543729340616,0.0400747514085084,0.0148032263352767,0.0134204607807494,0.0123749033905931,0.0104237618105852,0.0003117584915882,0.0012194634875049,0.0037792764082325,0.0080908751388368,0.0251803304124270,0.0241856723678360,0.0118913596077216,0.0107355203021735,0.0098723522336265,0.0081651033511197,0.0003138792976534,0.0008864969352644,0.0023540947324007,0.0050305519867158,0.0153440318819093,0.0139867160001647,0.0086825800310348,0.0077536669744659,0.0072404319066812,0.0063921094805908,0.0002438926975010,0.0005471679648283,0.0011325104388306,0.0023074369989658,0.0066996263600486,0.0056116528485877,0.0046212364161272,0.0042182832637343,0.0040040818511465,0.0042331289061909,0.0003181209097839,0.0012873292815921,0.0045851827130184,0.0106209967746513,0.0400747514085084,-0.9574417846891121,0.0190236304050762,0.0173694016742000,0.0160057233742598,0.0134098567504233,0.0001993557701312,0.0007762150198727,0.0029224707578813,0.0073422305978120,0.0271187471560435,0.0282406535645479,0.0152634412514307,0.0138191723210119,0.0127884605733121,0.0106994665990646,0.0001548188427615,0.0004793021707411,0.0017030072703764,0.0045639746523661,0.0170661264068727,0.0167755759759368,0.0109242720419786,0.0098638690093656,0.0093463923294505,0.0085426068307299,0.0001102819153917,0.0002714631763489,0.0007804566320031,0.0021250476773563,0.0078045663200313,0.0069286734150930,0.0056901226730011,0.0052786862963472,0.0051175050353901,0.0056795186426749,0.0000699866001525,0.0002735839824141,0.0011219064085045,0.0029776117155771,0.0148032263352767,0.0190236304050762,-0.8700815412503272,0.1065959544503837,0.0953429574682951,0.0767816627854381,0.0000339328970436,0.0001378523942397,0.0006532082680896,0.0019617456103339,0.0095266608449947,0.0117704736620037,0.0739440242701659,0.0727139567523349,0.0763723472148495,0.0766310855548071,0.0000169664485218,0.0000657449880220,0.0003393289704361,0.0011961346207874,0.0059721898796761,0.0068926197119841,0.0370716900201486,0.0446047931638309,0.0530731717822779,0.0710745736639152,0.0000106040303261,0.0000296912849132,0.0001378523942397,0.0005577719951544,0.0030836520188384,0.0031684842614475,0.0134310648110756,0.0188666907562495,0.0248706927269040,0.0465941092530128,0.0000530201516306,0.0002014765761965,0.0008971009655906,0.0025428464722058,0.0134204607807494,0.0173694016742000,0.1065959544503837,-0.8758777042265896,0.1171151525339041,0.1017859662944513,0.0000233288667175,0.0000933154668699,0.0004962686192629,0.0016245374459630,0.0088628485465790,0.0113590372853499,0.0723873526182901,0.0780668712609650,0.0820009665119590,0.0907895868462551,0.0000084832242609,0.0000381745091741,0.0002417718914358,0.0009692083718082,0.0055416662484352,0.0067674921541358,0.0424118796923873,0.0460108875850757,0.0523542185261663,0.0724658224427034,0.0000042416121305,0.0000148456424566,0.0000890738547395,0.0004474900797627,0.0028927794729681,0.0031239473340777,0.0167161934061105,0.0196683554489049,0.0238018064700302,0.0418265372183850,0.0000381745091741,0.0001505772306310,0.0007210740621768,0.0022056383078349,0.0123749033905931,0.0160057233742598,0.0953429574682951,0.1171151525339041,-0.8583534837096281,0.1466134440951310,0.0000148456424566,0.0000657449880220,0.0003796242856754,0.0013530742696141,0.0082075194724242,0.0106676545080862,0.0674967738318792,0.0807857446365846,0.0921044866066952,0.1115925735400559,0.0000042416121305,0.0000233288667175,0.0001739060973485,0.0007698526016770,0.0050984177808030,0.0064960289777869,0.0439706721503284,0.0488421636821522,0.0534146215587793,0.0741794337434059,0.0000021208060652,0.0000063624181957,0.0000593825698263,0.0003456913886318,0.0026234371026844,0.0030285110611426,0.0208729732939532,0.0211253492157151,0.0218549065021528,0.0351693269796409,0.0000254496727827,0.0000996778850656,0.0005195974859803,0.0017433025856157,0.0104237618105852,0.0134098567504233,0.0767816627854381,0.1017859662944513,0.1466134440951310,-0.6291664554649270,0.0000084832242609,0.0000381745091741,0.0002544967278271,0.0010137452991780,0.0069413982514843,0.0090388754499927,0.0551112664109600,0.0684999151007310,0.0872139078202843,0.1633699328164807,0.0000021208060652,0.0000127248363914,0.0001060403032613,0.0005344431284369,0.0042394913243866,0.0055819615636745,0.0412157450715999,0.0446620549275920,0.0466450085985782,0.0618575505044435,-0.0000000000000000,0.0000021208060652,0.0000318120909784,0.0002226846368487,0.0020741483317909,0.0026022290420322,0.0243723033015759,0.0224720610671335,0.0177532675720059,0.0050390352109767,0.0125106349787675,0.0135392259204021,0.0024813430963143,0.0010285909416346,0.0003117584915882,0.0001993557701312,0.0000339328970436,0.0000233288667175,0.0000148456424566,0.0000084832242609,-0.9659377337864070,0.0147905014988854,0.0014612353789406,0.0006892619711984,0.0002078389943921,0.0001336107821092,0.0000190872545870,0.0000127248363914,0.0000063624181957,0.0000021208060652,0.0059064448916541,0.0024664974538577,0.0007507653470900,0.0004962686192629,0.0001378523942397,0.0000869530486743,0.0000106040303261,0.0000042416121305,0.0000021208060652,-0.0000000000000000,-0.0053953306299347,-0.0019575039982035,0.0004390068555018,0.0003032752673273,0.0000805906304786,0.0000487785395002,0.0000042416121305,0.0000021208060652,-0.0000000000000000,-0.0000000000000000,0.0038937999357547,0.0184913080827045,0.0079190898475535,0.0040040818511465,0.0012194634875049,0.0007762150198727,0.0001378523942397,0.0000933154668699,0.0000657449880220,0.0000381745091741,0.0147905014988854,-0.9657680693011890,0.0059637066554152,0.0027824975575764,0.0008122687229815,0.0005217182920456,0.0000827114365438,0.0000508993455654,0.0000318120909784,0.0000169664485218,0.0086847008371000,0.0135158970536846,0.0034102561528832,0.0018641885313336,0.0005302015163065,0.0003435705825666,0.0000466577334350,0.0000254496727827,0.0000127248363914,0.0000063624181957,0.0019193294890294,0.0027888599757720,0.0016966448521807,0.0010497990022868,0.0003075168794578,0.0001908725458703,0.0000212080606523,0.0000084832242609,0.0000042416121305,-0.0000000000000000,0.0001696644852181,0.0047612096164321,0.0109857754178701,0.0084811034548383,0.0037792764082325,0.0029224707578813,0.0006532082680896,0.0004962686192629,0.0003796242856754,0.0002544967278271,0.0014612353789406,0.0059637066554152,-0.9876844791792333,0.0077769958411833,0.0030751687945775,0.0023540947324007,0.0004453692736974,0.0003117584915882,0.0002163222186530,0.0001293691699788,0.0023477323142051,0.0054992501271307,0.0065426867112219,0.0054738004543480,0.0022586584594656,0.0017496650038114,0.0002841880127403,0.0001760269034137,0.0001081611093265,0.0000551409576959,0.0019362959375512,0.0036117327290797,0.0026191954905540,0.0029797325216424,0.0013785239423968,0.0009988996567214,0.0001505772306310,0.0000784698244134,0.0000424161213045,0.0000212080606523,0.0006553290741548,0.0033996521225571,0.0090494794803189,0.0124894269181153,0.0080908751388368,0.0073422305978120,0.0019617456103339,0.0016245374459630,0.0013530742696141,0.0010137452991780,0.0006892619711984,0.0027824975575764,0.0077769958411833,-0.9844375250933725,0.0081651033511197,0.0067823377965924,0.0014612353789406,0.0011325104388306,0.0008822553231340,0.0006001881164589,0.0008207519472424,0.0022544168473351,0.0050051023139331,0.0078236535746183,0.0054780420664785,0.0048333170226498,0.0010222285234389,0.0007295572864377,0.0005259599041760,0.0003244833279796,0.0006913827772636,0.0015078931123756,0.0025152759933579,0.0030560815399905,0.0030645647642514,0.0025555713085972,0.0005959465043285,0.0003796242856754,0.0002544967278271,0.0001569396488267,0.0003329665522405,0.0013276245968314,0.0045003504704093,0.0091852110684933,0.0251803304124270,0.0271187471560435,0.0095266608449947,0.0088628485465790,0.0082075194724242,0.0069413982514843,0.0002078389943921,0.0008122687229815,0.0030751687945775,0.0081651033511197,-0.9599825103552527,0.0300115266290116,0.0084005128243597,0.0072149822338985,0.0063284852986341,0.0049393573259111,0.0001569396488267,0.0004983894253281,0.0018005643493768,0.0046594109253013,0.0162750657445435,0.0152634412514307,0.0062669819227425,0.0052362701750427,0.0044791424097571,0.0033890480922310,0.0001124027214570,0.0002820672066750,0.0008440808139599,0.0021886718593131,0.0075097742769649,0.0065363242930262,0.0036435448200581,0.0029564036549249,0.0024834639023795,0.0020762691378561,0.0002629799520880,0.0009882956263953,0.0037644307657760,0.0084089960486207,0.0241856723678360,0.0282406535645479,0.0117704736620037,0.0113590372853499,0.0106676545080862,0.0090388754499927,0.0001336107821092,0.0005217182920456,0.0023540947324007,0.0067823377965924,0.0300115266290116,-0.9684530097797649,0.0110197083149137,0.0095393856813861,0.0083814255697727,0.0065829820264612,0.0000721074062177,0.0002608591460228,0.0012661212209399,0.0041398134393209,0.0177956836933104,0.0182049992638990,0.0081502577086631,0.0068438411724839,0.0059573442372195,0.0046827397920188,0.0000424161213045,0.0001230067517831,0.0005365639345022,0.0019299335193556,0.0087186337341436,0.0080484590175323,0.0045703370705618,0.0037962428567543,0.0032999742374915,0.0029606452670553,0.0000466577334350,0.0001802685155442,0.0007995438865902,0.0022565376534003,0.0118913596077216,0.0152634412514307,0.0739440242701659,0.0723873526182901,0.0674967738318792,0.0551112664109600,0.0000190872545870,0.0000827114365438,0.0004453692736974,0.0014612353789406,0.0084005128243597,0.0110197083149137,-0.9065551639600821,0.0713630032887860,0.0626507319728380,0.0533891718859965,0.0000084832242609,0.0000339328970436,0.0002184430247183,0.0008674096806774,0.0048439210529759,0.0059000824734584,0.0420895171704730,0.0414914498600793,0.0457775989179008,0.0513341108087927,0.0000021208060652,0.0000106040303261,0.0000805906304786,0.0004029531523929,0.0024983095448361,0.0026255579087497,0.0135095346354889,0.0188348786652711,0.0245292429504026,0.0381660259498051,0.0000318120909784,0.0001230067517831,0.0006001881164589,0.0018705509495292,0.0107355203021735,0.0138191723210119,0.0727139567523349,0.0780668712609650,0.0807857446365846,0.0684999151007310,0.0000127248363914,0.0000508993455654,0.0003117584915882,0.0011325104388306,0.0072149822338985,0.0095393856813861,0.0713630032887860,-0.9114330179101016,0.0821769934153728,0.0722685874786374,0.0000042416121305,0.0000169664485218,0.0001399732003049,0.0006362418195678,0.0043115987306042,0.0055692367272832,0.0417862419031457,0.0465750219984258,0.0496820028839817,0.0609922616298314,-0.0000000000000000,0.0000042416121305,0.0000466577334350,0.0002863088188055,0.0021907926653783,0.0025280008297493,0.0182558986094645,0.0201285703650589,0.0232503968930714,0.0386941066600464,0.0000212080606523,0.0000848322426090,0.0004496108858279,0.0015587924579410,0.0098723522336265,0.0127884605733121,0.0763723472148495,0.0820009665119590,0.0921044866066952,0.0872139078202843,0.0000063624181957,0.0000318120909784,0.0002163222186530,0.0008822553231340,0.0063284852986341,0.0083814255697727,0.0626507319728380,0.0821769934153728,-0.8961526102101491,0.1082883576904339,0.0000021208060652,0.0000106040303261,0.0000890738547395,0.0004559733040236,0.0037114106141453,0.0049457197441068,0.0404480132759882,0.0494805263077852,0.0568842602814888,0.0752504408063450,-0.0000000000000000,0.0000021208060652,0.0000275704788479,0.0001908725458703,0.0017984435433116,0.0022629000715960,0.0214265036769772,0.0221009200057190,0.0230277122562227,0.0392603618794617,0.0000106040303261,0.0000487785395002,0.0002947920430664,0.0011515976934177,0.0081651033511197,0.0106994665990646,0.0766310855548071,0.0907895868462551,0.1115925735400559,0.1633699328164807,0.0000021208060652,0.0000169664485218,0.0001293691699788,0.0006001881164589,0.0049393573259111,0.0065829820264612,0.0533891718859965,0.0722685874786374,0.1082883576904339,-0.6936050269507505,-0.0000000000000000,0.0000042416121305,0.0000466577334350,0.0002757047884794,0.0027337190180762,0.0037411018990585,0.0358543473387089,0.0431965779365209,0.0544792662035227,0.1054061822477919,-0.0000000000000000,-0.0000000000000000,0.0000127248363914,0.0001017986911308,0.0012046178450483,0.0016521079248110,0.0211380740521064,0.0220139669570447,0.0214922486649992,0.0225505308915469,-0.0036541488503842,0.0039871154026247,0.0032787661768392,0.0014612353789406,0.0003138792976534,0.0001548188427615,0.0000169664485218,0.0000084832242609,0.0000042416121305,0.0000021208060652,0.0059064448916541,0.0086847008371000,0.0023477323142051,0.0008207519472424,0.0001569396488267,0.0000721074062177,0.0000084832242609,0.0000042416121305,0.0000021208060652,-0.0000000000000000,-0.9743361258047015,0.0124851853059848,0.0014336649000927,0.0004114363766538,0.0000721074062177,0.0000339328970436,0.0000021208060652,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,0.0011961346207874,0.0032936118192958,0.0005641344133501,0.0001739060973485,0.0000296912849132,0.0000148456424566,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.0046869814041492,0.0040783100634294,0.0069477606696800,0.0036011286987536,0.0008864969352644,0.0004793021707411,0.0000657449880220,0.0000381745091741,0.0000233288667175,0.0000127248363914,0.0024664974538577,0.0135158970536846,0.0054992501271307,0.0022544168473351,0.0004983894253281,0.0002608591460228,0.0000339328970436,0.0000169664485218,0.0000106040303261,0.0000042416121305,0.0124851853059848,-0.9711188630037538,0.0039107663842765,0.0013021749240487,0.0002651007581532,0.0001399732003049,0.0000148456424566,0.0000063624181957,0.0000021208060652,-0.0000000000000000,0.0061206463042419,0.0088798149951008,0.0016118126095717,0.0006107921467851,0.0001293691699788,0.0000699866001525,0.0000063624181957,0.0000021208060652,-0.0000000000000000,-0.0000000000000000,0.0002481343096314,0.0031048600794907,0.0060718677647417,0.0055480286666309,0.0023540947324007,0.0017030072703764,0.0003393289704361,0.0002417718914358,0.0001739060973485,0.0001060403032613,0.0007507653470900,0.0034102561528832,0.0065426867112219,0.0050051023139331,0.0018005643493768,0.0012661212209399,0.0002184430247183,0.0001399732003049,0.0000890738547395,0.0000466577334350,0.0014336649000927,0.0039107663842765,-0.9917967221397063,0.0045745786826922,0.0013764031363316,0.0009267922505037,0.0001293691699788,0.0000699866001525,0.0000381745091741,0.0000169664485218,0.0012767252512660,0.0026255579087497,0.0030603231521210,0.0024410477810750,0.0008143895290467,0.0005323223223717,0.0000615033758916,0.0000275704788479,0.0000106040303261,0.0000042416121305,0.0006828995530027,0.0026319203269453,0.0063200020743732,0.0067335592570922,0.0050305519867158,0.0045639746523661,0.0011961346207874,0.0009692083718082,0.0007698526016770,0.0005344431284369,0.0004962686192629,0.0018641885313336,0.0054738004543480,0.0078236535746183,0.0046594109253013,0.0041398134393209,0.0008674096806774,0.0006362418195678,0.0004559733040236,0.0002757047884794,0.0004114363766538,0.0013021749240487,0.0045745786826922,-0.9888021439756073,0.0049966190896722,0.0037707931839716,0.0006023089225242,0.0003753826735450,0.0002354094732401,0.0001208859457179,0.0003053960733925,0.0007762150198727,0.0021717054107913,0.0039807529844290,0.0025746585631842,0.0020084033437689,0.0003266041340448,0.0001760269034137,0.0000954362729352,0.0000445369273697,0.0002672215642185,0.0009734499839387,0.0033699608376439,0.0064239215715692,0.0153440318819093,0.0170661264068727,0.0059721898796761,0.0055416662484352,0.0050984177808030,0.0042394913243866,0.0001378523942397,0.0005302015163065,0.0022586584594656,0.0054780420664785,0.0162750657445435,0.0177956836933104,0.0048439210529759,0.0043115987306042,0.0037114106141453,0.0027337190180762,0.0000721074062177,0.0002651007581532,0.0013764031363316,0.0049966190896722,-0.9685484460527001,0.0212632016099548,0.0043879477489524,0.0032617997283174,0.0024664974538577,0.0015672756822019,0.0000402953152393,0.0001208859457179,0.0005768592497414,0.0019999201195080,0.0082753852665114,0.0074100963918993,0.0026001082359669,0.0018238932160943,0.0012724836391355,0.0007740942138074,0.0001972349640660,0.0007168324500464,0.0028079472303591,0.0058788744128062,0.0139867160001647,0.0167755759759368,0.0068926197119841,0.0067674921541358,0.0064960289777869,0.0055819615636745,0.0000869530486743,0.0003435705825666,0.0017496650038114,0.0048333170226498,0.0152634412514307,0.0182049992638990,0.0059000824734584,0.0055692367272832,0.0049457197441068,0.0037411018990585,0.0000339328970436,0.0001399732003049,0.0009267922505037,0.0037707931839716,0.0212632016099548,-0.9782193217101302,0.0058597871582191,0.0044473303187787,0.0034272226014050,0.0022629000715960,0.0000127248363914,0.0000466577334350,0.0003414497765014,0.0016733159854632,0.0094227413477986,0.0090197881954057,0.0034038937346876,0.0024516518114011,0.0018005643493768,0.0011940138147222,0.0000296912849132,0.0001124027214570,0.0005429263526978,0.0016457455066153,0.0086825800310348,0.0109242720419786,0.0370716900201486,0.0424118796923873,0.0439706721503284,0.0412157450715999,0.0000106040303261,0.0000466577334350,0.0002841880127403,0.0010222285234389,0.0062669819227425,0.0081502577086631,0.0420895171704730,0.0417862419031457,0.0404480132759882,0.0358543473387089,0.0000021208060652,0.0000148456424566,0.0001293691699788,0.0006023089225242,0.0043879477489524,0.0058597871582191,-0.9369420732626386,0.0438794774895237,0.0376018915364550,0.0321789904276724,-0.0000000000000000,0.0000042416121305,0.0000424161213045,0.0002693423702837,0.0020020409255732,0.0022692624897917,0.0174372674682873,0.0187182343316837,0.0212738056402809,0.0235557929664640,0.0000169664485218,0.0000678657940872,0.0003690202553493,0.0012809668633964,0.0077536669744659,0.0098638690093656,0.0446047931638309,0.0460108875850757,0.0488421636821522,0.0446620549275920,0.0000042416121305,0.0000254496727827,0.0001760269034137,0.0007295572864377,0.0052362701750427,0.0068438411724839,0.0414914498600793,0.0465750219984258,0.0494805263077852,0.0431965779365209,-0.0000000000000000,0.0000063624181957,0.0000699866001525,0.0003753826735450,0.0032617997283174,0.0044473303187787,0.0438794774895237,-0.9406025845312185,0.0519830774647518,0.0465771428044910,-0.0000000000000000,-0.0000000000000000,0.0000212080606523,0.0001548188427615,0.0015248595608974,0.0019468999678774,0.0192166237570118,0.0209917384336059,0.0217043292715218,0.0312585605953644,0.0000084832242609,0.0000402953152393,0.0002544967278271,0.0010222285234389,0.0072404319066812,0.0093463923294505,0.0530731717822779,0.0523542185261663,0.0534146215587793,0.0466450085985782,0.0000021208060652,0.0000127248363914,0.0001081611093265,0.0005259599041760,0.0044791424097571,0.0059573442372195,0.0457775989179008,0.0496820028839817,0.0568842602814888,0.0544792662035227,-0.0000000000000000,0.0000021208060652,0.0000381745091741,0.0002354094732401,0.0024664974538577,0.0034272226014050,0.0376018915364550,0.0519830774647518,-0.9310441115952455,0.0760945216203049,-0.0000000000000000,-0.0000000000000000,0.0000084832242609,0.0000827114365438,0.0010540406144173,0.0014718394092668,0.0195750399820350,0.0223151214183068,0.0252142633094706,0.0417162553029932,0.0000042416121305,0.0000212080606523,0.0001526980366963,0.0007337988985682,0.0063921094805908,0.0085426068307299,0.0710745736639152,0.0724658224427034,0.0741794337434059,0.0618575505044435,-0.0000000000000000,0.0000063624181957,0.0000551409576959,0.0003244833279796,0.0033890480922310,0.0046827397920188,0.0513341108087927,0.0609922616298314,0.0752504408063450,0.1054061822477919,-0.0000000000000000,-0.0000000000000000,0.0000169664485218,0.0001208859457179,0.0015672756822019,0.0022629000715960,0.0321789904276724,0.0465771428044910,0.0760945216203049,-0.7502411529226078,-0.0000000000000000,-0.0000000000000000,0.0000021208060652,0.0000339328970436,0.0005662552194153,0.0008546848442860,0.0157194145554543,0.0206184765661261,0.0277062104361110,0.0591514019652153,-0.0070940962881806,-0.0025831417874451,0.0022671416837265,0.0011961346207874,0.0002438926975010,0.0001102819153917,0.0000106040303261,0.0000042416121305,0.0000021208060652,-0.0000000000000000,-0.0053953306299347,0.0019193294890294,0.0019362959375512,0.0006913827772636,0.0001124027214570,0.0000424161213045,0.0000021208060652,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,0.0011961346207874,0.0061206463042419,0.0012767252512660,0.0003053960733925,0.0000402953152393,0.0000127248363914,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.9796190537131793,0.0098978019064092,0.0006298794013721,0.0000954362729352,0.0000106040303261,0.0000021208060652,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.0052532366235645,-0.0027040277331630,0.0040973973180164,0.0023986316597705,0.0005471679648283,0.0002714631763489,0.0000296912849132,0.0000148456424566,0.0000063624181957,0.0000021208060652,-0.0019575039982035,0.0027888599757720,0.0036117327290797,0.0015078931123756,0.0002820672066750,0.0001230067517831,0.0000106040303261,0.0000042416121305,0.0000021208060652,-0.0000000000000000,0.0032936118192958,0.0088798149951008,0.0026255579087497,0.0007762150198727,0.0001208859457179,0.0000466577334350,0.0000042416121305,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,0.0098978019064092,-0.9786668117898928,0.0016839200157894,0.0003329665522405,0.0000445369273697,0.0000169664485218,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,0.0003117584915882,0.0016563495369414,0.0022289671745524,0.0026764572543151,0.0011325104388306,0.0007804566320031,0.0001378523942397,0.0000890738547395,0.0000593825698263,0.0000318120909784,0.0004390068555018,0.0016966448521807,0.0026191954905540,0.0025152759933579,0.0008440808139599,0.0005365639345022,0.0000805906304786,0.0000466577334350,0.0000275704788479,0.0000127248363914,0.0005641344133501,0.0016118126095717,0.0030603231521210,0.0021717054107913,0.0005768592497414,0.0003414497765014,0.0000424161213045,0.0000212080606523,0.0000084832242609,0.0000021208060652,0.0006298794013721,0.0016839200157894,-0.9951497165288284,0.0019511415800078,0.0004135571827190,0.0002120806065226,0.0000190872545870,0.0000063624181957,0.0000021208060652,-0.0000000000000000,0.0004686981404149,0.0015503092336801,0.0032405916676652,0.0023816652112487,0.0023074369989658,0.0021250476773563,0.0005577719951544,0.0004474900797627,0.0003456913886318,0.0002226846368487,0.0003032752673273,0.0010497990022868,0.0029797325216424,0.0030560815399905,0.0021886718593131,0.0019299335193556,0.0004029531523929,0.0002863088188055,0.0001908725458703,0.0001017986911308,0.0001739060973485,0.0006107921467851,0.0024410477810750,0.0039807529844290,0.0019999201195080,0.0016733159854632,0.0002693423702837,0.0001548188427615,0.0000827114365438,0.0000339328970436,0.0000954362729352,0.0003329665522405,0.0019511415800078,-0.9927765345418407,0.0025492088904015,0.0014930474699190,0.0001569396488267,0.0000636241819568,0.0000254496727827,0.0000084832242609,0.0001696644852181,0.0005917048921980,0.0020105241498341,0.0034675179166443,0.0066996263600486,0.0078045663200313,0.0030836520188384,0.0028927794729681,0.0026234371026844,0.0020741483317909,0.0000805906304786,0.0003075168794578,0.0013785239423968,0.0030645647642514,0.0075097742769649,0.0087186337341436,0.0024983095448361,0.0021907926653783,0.0017984435433116,0.0012046178450483,0.0000296912849132,0.0001293691699788,0.0008143895290467,0.0025746585631842,0.0082753852665114,0.0094227413477986,0.0020020409255732,0.0015248595608974,0.0010540406144173,0.0005662552194153,0.0000106040303261,0.0000445369273697,0.0004135571827190,0.0025492088904015,-0.9765332808882755,0.0131426351862048,0.0018620677252683,0.0009564835354169,0.0004920270071324,0.0002014765761965,0.0001145235275222,0.0004071947645234,0.0015566716518758,0.0029776117155771,0.0056116528485877,0.0069286734150930,0.0031684842614475,0.0031239473340777,0.0030285110611426,0.0026022290420322,0.0000487785395002,0.0001908725458703,0.0009988996567214,0.0025555713085972,0.0065363242930262,0.0080484590175323,0.0026255579087497,0.0025280008297493,0.0022629000715960,0.0016521079248110,0.0000148456424566,0.0000699866001525,0.0005323223223717,0.0020084033437689,0.0074100963918993,0.0090197881954057,0.0022692624897917,0.0019468999678774,0.0014718394092668,0.0008546848442860,0.0000021208060652,0.0000169664485218,0.0002120806065226,0.0014930474699190,0.0131426351862048,-0.9876166133851461,0.0025237592176188,0.0014124568394404,0.0007783358259379,0.0003456913886318,0.0000148456424566,0.0000572617637611,0.0003032752673273,0.0009501211172212,0.0046212364161272,0.0056901226730011,0.0134310648110756,0.0167161934061105,0.0208729732939532,0.0243723033015759,0.0000042416121305,0.0000212080606523,0.0001505772306310,0.0005959465043285,0.0036435448200581,0.0045703370705618,0.0135095346354889,0.0182558986094645,0.0214265036769772,0.0211380740521064,-0.0000000000000000,0.0000063624181957,0.0000615033758916,0.0003266041340448,0.0026001082359669,0.0034038937346876,0.0174372674682873,0.0192166237570118,0.0195750399820350,0.0157194145554543,-0.0000000000000000,-0.0000000000000000,0.0000190872545870,0.0001569396488267,0.0018620677252683,0.0025237592176188,-0.9608308327813431,0.0245695382656419,0.0170958176917859,0.0105552517866293,0.0000063624181957,0.0000296912849132,0.0001823893216094,0.0006892619711984,0.0042182832637343,0.0052786862963472,0.0188666907562495,0.0196683554489049,0.0211253492157151,0.0224720610671335,0.0000021208060652,0.0000084832242609,0.0000784698244134,0.0003796242856754,0.0029564036549249,0.0037962428567543,0.0188348786652711,0.0201285703650589,0.0221009200057190,0.0220139669570447,-0.0000000000000000,0.0000021208060652,0.0000275704788479,0.0001760269034137,0.0018238932160943,0.0024516518114011,0.0187182343316837,0.0209917384336059,0.0223151214183068,0.0206184765661261,-0.0000000000000000,-0.0000000000000000,0.0000063624181957,0.0000636241819568,0.0009564835354169,0.0014124568394404,0.0245695382656419,-0.9658253310649501,0.0262152837722572,0.0217997655444569,0.0000021208060652,0.0000148456424566,0.0001166443335874,0.0005323223223717,0.0040040818511465,0.0051175050353901,0.0248706927269040,0.0238018064700302,0.0218549065021528,0.0177532675720059,-0.0000000000000000,0.0000042416121305,0.0000424161213045,0.0002544967278271,0.0024834639023795,0.0032999742374915,0.0245292429504026,0.0232503968930714,0.0230277122562227,0.0214922486649992,-0.0000000000000000,-0.0000000000000000,0.0000106040303261,0.0000954362729352,0.0012724836391355,0.0018005643493768,0.0212738056402809,0.0217043292715218,0.0252142633094706,0.0277062104361110,-0.0000000000000000,-0.0000000000000000,0.0000021208060652,0.0000254496727827,0.0004920270071324,0.0007783358259379,0.0170958176917859,0.0262152837722572,-0.9620460546567174,0.0446132763880918,-0.0000000000000000,0.0000063624181957,0.0000721074062177,0.0004220404069800,0.0042331289061909,0.0056795186426749,0.0465941092530128,0.0418265372183850,0.0351693269796409,0.0050390352109767,-0.0000000000000000,-0.0000000000000000,0.0000212080606523,0.0001569396488267,0.0020762691378561,0.0029606452670553,0.0381660259498051,0.0386941066600464,0.0392603618794617,0.0225505308915469,-0.0000000000000000,-0.0000000000000000,0.0000042416121305,0.0000445369273697,0.0007740942138074,0.0011940138147222,0.0235557929664640,0.0312585605953644,0.0417162553029932,0.0591514019652153,-0.0000000000000000,-0.0000000000000000,-0.0000000000000000,0.0000084832242609,0.0002014765761965,0.0003456913886318,0.0105552517866293,0.0217997655444569,0.0446132763880918,-0.8042008216401502,};
	d_fgm h_x[20][40] = {-0.0085326582012882,-0.0136007124517218,-0.0032642756792532,-0.0012822815131643,-0.0003082510702735,-0.0001692666865891,-0.0000249586633538,-0.0000150916463535,-0.0000095311599159,-0.0000051393933917,-0.0133332510556452,-0.0115464265433669,-0.0019353291464573,-0.0007416541284279,-0.0001747002423857,-0.0000966569076909,-0.0000132689216731,-0.0000074087093582,-0.0000041423976786,-0.0000018543257734,-0.0069947881636584,-0.0058082127202598,-0.0010444675434706,-0.0004383350660831,-0.0000998526115847,-0.0000561320739632,-0.0000066508457854,-0.0000031240623299,-0.0000013916029882,-0.0000004392776599,0.0003473405528393,-0.0012107267258028,-0.0004910557655483,-0.0002319695512130,-0.0000537060216041,-0.0000297057300705,-0.0000027664823240,-0.0000009487850920,-0.0000002808462190,-0.0000000078607125,0.0101362776902548,0.0051742093152000,-0.0000225403208037,0.0001815905218124,0.0001844578901564,0.0001657634760726,0.0000397790621147,0.0000307371032876,0.0000234544494209,0.0000155912572068,0.0020609148907561,-0.0002644211111122,-0.0000887595070556,0.0002925725928233,0.0001731249615763,0.0001429676485004,0.0000276971785028,0.0000192896635593,0.0000132711286077,0.0000077768217878,-0.0027472116216662,-0.0028544380496935,0.0000454360529915,0.0003228260544724,0.0001424142409853,0.0001098738842607,0.0000177166970787,0.0000107156546079,0.0000065182882928,0.0000033821385042,-0.0026093115044554,-0.0023601527820041,0.0001034632154585,0.0002199080755013,0.0000912507893137,0.0000638049246955,0.0000092270512942,0.0000047138704363,0.0000025680721622,0.0000012983453826,0.0028266064645265,-0.0004183994388045,-0.0002919180344571,0.0011041278420995,0.0009392030152636,0.0008542218445996,0.0002174663858906,0.0001744222922059,0.0001392022386681,0.0000985053721945,-0.0013618068445147,-0.0061905561441462,0.0001681212602256,0.0013928978606753,0.0008582706854180,0.0007426501748558,0.0001562705989471,0.0001155317860404,0.0000849732749290,0.0000541061322990,-0.0037848851205809,-0.0071167528463084,0.0003550394456067,0.0012625083430329,0.0006880543454043,0.0005713052778472,0.0001052859116521,0.0000694585459517,0.0000465032899428,0.0000270688241934,-0.0028482201153553,-0.0042695780766023,0.0002254450622331,0.0007479255075152,0.0004272132616864,0.0003240829729677,0.0000579494639040,0.0000334628788849,0.0000206688318662,0.0000122991239516,0.0102624689652143,0.0159173362011054,0.0033286979707226,0.0022604114990669,0.0010622519178421,0.0008347073953035,0.0001882412856081,0.0001437159249849,0.0001103203012582,0.0000748014599563,0.0062234299632117,0.0067708612184160,0.0022225817893219,0.0019456723137904,0.0008536293643216,0.0006662279162687,0.0001286592571652,0.0000907225377527,0.0000639154862562,0.0000387991745658,0.0005438131693086,-0.0002040586388740,0.0015061034548275,0.0015543370561498,0.0006422664215760,0.0004923211221425,0.0000827923949251,0.0000517790415928,0.0000328726622859,0.0000180454417580,-0.0022231340255473,-0.0024896791117420,0.0008124588226703,0.0009152711691873,0.0003929718073110,0.0002792258592732,0.0000438813240570,0.0000236800527243,0.0000137263657650,0.0000075810060400,0.0021651894725073,0.0063116300154418,0.0033463237644972,0.0036328458170758,0.0033489558878909,0.0033262950002767,0.0009923849406957,0.0008571678348249,0.0007405561292238,0.0005787028974915,0.0032586512405975,0.0059286121535246,0.0002475386636441,0.0027398867936150,0.0029672078974741,0.0029148187229594,0.0007631164494322,0.0006265152531077,0.0005135694060878,0.0003700825106957,0.0023591640694826,0.0035499824928178,-0.0011045563373968,0.0016074855325547,0.0022753299756088,0.0021738526447513,0.0005575668024224,0.0004232219292377,0.0003276493899657,0.0002256051119370,0.0006012430387425,0.0009769522888707,-0.0009797099022332,0.0005549527635201,0.0013063871764115,0.0011465667354796,0.0003245234198350,0.0002260858098587,0.0001667602156818,0.0001243329180175,0.0017096078041644,0.0108458040826912,0.0204389336306001,0.0156671608924776,0.0081714712679614,0.0069321840480949,0.0017762853227508,0.0014486255702725,0.0011913351352258,0.0008820455896806,0.0039257739205111,0.0111928538188743,0.0135553467955294,0.0121468845460932,0.0066561630860492,0.0057261031250781,0.0012910588063010,0.0009958139461213,0.0007710991977400,0.0005235756437932,0.0045542401750879,0.0092819919536736,0.0072593347175444,0.0082675494881705,0.0049631102872368,0.0042410484567350,0.0008958785735947,0.0006324247792157,0.0004572219237817,0.0002928553112613,0.0028482550643782,0.0051625506330068,0.0025760941041151,0.0041022841585624,0.0029222039603608,0.0023161673250624,0.0005053864820188,0.0003215328009960,0.0002194597869047,0.0001498210852687,-0.0001108621152057,0.0013962806955072,0.0021193524889771,0.0022812116673862,0.0035077265213631,0.0037962819177637,0.0015584855014075,0.0014620546084176,0.0013691327694161,0.0011651436330590,0.0006471807475023,0.0021914846661823,0.0016527298320058,-0.0005199489386234,0.0025545626323831,0.0028646642482233,0.0012975814263316,0.0011876926002243,0.0010872172965984,0.0008845238228148,0.0010984104959156,0.0023082645613203,0.0010173879593211,-0.0015804582965230,0.0016083818944353,0.0018016227861029,0.0009899473778432,0.0008728600801527,0.0007898280963282,0.0006604195724603,0.0008449110568803,0.0015137025961140,0.0003828061274414,-0.0012283476445440,0.0007370550896805,0.0007842670664207,0.0005596698455285,0.0004853571297352,0.0004362572320713,0.0004238788248748,0.0005343500182632,0.0045890256946407,0.0117119097531191,0.0178480006846889,0.0123027199954533,0.0112590933375806,0.0034417721756394,0.0029984237427469,0.0026442091187075,0.0021267426089854,0.0012404275207667,0.0045933064549961,0.0085921121007945,0.0115331360586807,0.0095583896699935,0.0088821269635879,0.0026630812200389,0.0022550395358193,0.0019290815074540,0.0014684618583229,0.0017719026449599,0.0041855393963745,0.0055205793328591,0.0060256208194237,0.0065953550044718,0.0060925310253030,0.0019473632775212,0.0015667018861015,0.0013039832401195,0.0009949794706492,0.0014030442934612,0.0027390177354406,0.0025872544935328,0.0020563015349651,0.0034980018044834,0.0030240929631065,0.0011079546524209,0.0008479217055195,0.0006904982200494,0.0005986897603548,0.0000613367786417,0.0003966423020885,0.0007984329004024,0.0006298226585745,0.0008375555172165,-0.0025545430402378,-0.0008237213368680,-0.0007306235190766,-0.0005962327065921,-0.0004243850255361,0.0001019135993593,0.0003895384564667,0.0007490775842375,0.0005942710321943,-0.0006612269820554,-0.0030153329659181,-0.0006714479452654,-0.0005072062250483,-0.0003455197655893,-0.0001800326914721,0.0001364449339931,0.0003493318400665,0.0005866895379805,0.0004308360470279,-0.0012746582536348,-0.0025902131829149,-0.0005151071073010,-0.0003167328564844,-0.0001744659876042,-0.0000323786660232,0.0001119344182391,0.0002345352096995,0.0003250838568191,0.0002076746921246,-0.0011580495828847,-0.0014752290055936,-0.0002981245978513,-0.0001594162120116,-0.0000789391026458,0.0000114887308430,0.0000854739820868,0.0004206156246177,0.0012919172489652,0.0025615348879325,0.0076081905465432,0.0074975030738779,0.0036858151741617,0.0034081978253793,0.0031719443601108,0.0026745161789610,0.0000821344764782,0.0003170916941135,0.0008960397263415,0.0017975907801972,0.0053009697246034,0.0050368815185493,0.0029871620906996,0.0027339959413285,0.0025668624973972,0.0021859318140319,0.0000903640457195,0.0002430687090357,0.0005649987455611,0.0011058407275544,0.0031635987850594,0.0028370888224460,0.0021140288960185,0.0019519144174821,0.0018877063085200,0.0017782154051096,0.0000707614437695,0.0001527484295660,0.0002726061711403,0.0005001661884935,0.0013385318368159,0.0010965352699009,0.0010891714807233,0.0010408737361710,0.0010315332357501,0.0011872719319939,0.0000435533487143,0.0002129384069876,0.0005966152027015,0.0012695423862472,0.0065205393006672,0.0072977715771611,0.0114041888830969,0.0109896691892389,0.0106087338339451,0.0091051282431652,0.0000439933252509,0.0001691939729743,0.0004340085740775,0.0007476998420293,0.0028899046370680,0.0030166664864564,0.0092484660659280,0.0090018924387762,0.0090542329356543,0.0083852080160729,0.0000491308298652,0.0001346635132357,0.0003027151224720,0.0004227819586249,0.0005234310887491,0.0003575303427939,0.0060521139820987,0.0063062273905140,0.0067888714586098,0.0074634662055914,0.0000392763471968,0.0000870796356603,0.0001618397383789,0.0001970080899548,-0.0004437612754498,-0.0006053185223070,0.0027407725848899,0.0031823686794466,0.0036275591122191,0.0050916151875013,0.0003137047404174,0.0013350896335238,0.0045438067867736,0.0100542923043223,0.0343787996545733,0.0367030187635055,0.0202145701882282,0.0187305173902071,0.0174641417077299,0.0146967158459504,0.0002222576569823,0.0008650708889628,0.0029759703913442,0.0070177725378494,0.0247439617414281,0.0253014938940304,0.0162115638401918,0.0149317693197059,0.0141271059234568,0.0122065296031377,0.0001970043153818,0.0005785558572188,0.0017855614408002,0.0043493934120820,0.0151419953360601,0.0145921806074206,0.0112806365232566,0.0105392754995215,0.0103220172870354,0.0100362948922502,0.0001474151352438,0.0003425501794731,0.0008363522289405,0.0020148140205085,0.0066881163727334,0.0058096432850820,0.0057188849292249,0.0055357719746274,0.0055726198129396,0.0066776675041073,0.0000040550012188,0.0000176975662712,0.0000596337409977,0.0001140165014655,0.0000922463784376,0.0000339224648025,0.0065377280782904,0.0107438202558383,0.0171588657445596,0.0205053091335387,0.0000029301715383,0.0000115787652452,0.0000400244920532,0.0000928091308670,0.0002195370354838,0.0001653345773980,-0.0008383296394586,0.0071918474134246,0.0125337536013838,0.0209001920505578,0.0000027182293518,0.0000078875774435,0.0000237474995264,0.0000605738138471,0.0002560818088139,0.0002779438688790,-0.0003716492464408,0.0031936683962566,0.0053923144291586,0.0140346104760102,0.0000020871953409,0.0000047521488747,0.0000108558562434,0.0000283068830578,0.0001620217289505,0.0001925982208257,0.0010154275077941,0.0006540586820362,0.0005496753451801,0.0047414437859549,0.0000281115610838,0.0001089714120494,0.0004335261598306,0.0011143756626549,0.0051387113120360,0.0064607572202235,0.0380404003337311,0.0350875342863374,0.0344069182824030,0.0298458104750718,0.0000147041538496,0.0000579124674290,0.0002576522994624,0.0007451610743756,0.0034507518507143,0.0041669094803647,0.0233472463508254,0.0250515712079329,0.0274961256850149,0.0297909806077147,0.0000090099820964,0.0000303032414143,0.0001376715006139,0.0004561222447415,0.0021907244250964,0.0024881301395304,0.0119155654094216,0.0150468424632198,0.0181970317381143,0.0260222511727450,0.0000057270590542,0.0000150283522186,0.0000573268700702,0.0002129422917612,0.0011232998688182,0.0011475743916898,0.0046544435976079,0.0062177080225825,0.0080409935932657,0.0158383773115359,0.0000188004763186,0.0000716476820327,0.0002573201790630,0.0005487028911605,0.0017030028171407,0.0020319038303705,0.0077041108855351,0.0041657514706256,0.0004245449765433,0.0047711200559008,0.0000103675773131,0.0000401841902161,0.0001659950364767,0.0004181737324401,0.0013027126415099,0.0013736500952859,0.0037044381433098,-0.0000419388016651,0.0004289342049862,0.0054478859439963,0.0000065392252578,0.0000218769042481,0.0000947192471495,0.0002804679188455,0.0009359641488224,0.0008481596991988,-0.0010336990442308,-0.0007851927789394,0.0008817813616185,0.0046463624585066,0.0000042045536102,0.0000111408496800,0.0000416303925696,0.0001371928358066,0.0005197916212102,0.0004129994680350,-0.0018637279900093,-0.0006940542696104,0.0004375345851091,0.0027312967836976,0.0000200981366224,0.0000759569840510,0.0003236783498062,0.0008823254438739,0.0043942780189085,0.0056333823592170,0.0320826383713596,0.0346743843910891,0.0349945201143105,0.0340472676582813,0.0000092547842699,0.0000367959712737,0.0001842367648841,0.0005772071136584,0.0029550832743548,0.0037200725652776,0.0223848587836605,0.0236822140178068,0.0255266980195579,0.0301093084666636,0.0000044345162660,0.0000164973526042,0.0000928602854992,0.0003492604926901,0.0018756027701014,0.0022337594902445,0.0125962686170633,0.0138996597389631,0.0160717925615700,0.0230033780302123,0.0000023441113488,0.0000069235577884,0.0000359322846206,0.0001628084245569,0.0009835168446714,0.0010390179766211,0.0048794531990310,0.0058702566883601,0.0071358262903894,0.0127573275028667,0.0000144947867945,0.0000536260207283,0.0002141667738271,0.0005043840002474,0.0018385534969266,0.0022813839270518,0.0063550428664095,0.0084745651364374,0.0087601815125202,0.0111150316664046,0.0000067395105826,0.0000265205131612,0.0001294583597522,0.0003702126785550,0.0014698988065333,0.0017721353097577,0.0051832663236362,0.0034732065266046,0.0011318868691598,0.0038965971580880,0.0000030917647851,0.0000117591961013,0.0000677498131737,0.0002449116991819,0.0010759130627809,0.0011868300402327,0.0024317086407303,0.0002781543938915,-0.0011391559999319,-0.0000856989550790,0.0000015389734316,0.0000047518592057,0.0000265971805001,0.0001204785480329,0.0006324043321147,0.0005908630316417,-0.0002876341068324,-0.0005353627614220,-0.0006168372967548,-0.0008776689077325,0.0000195128418967,0.0000735383052874,0.0003344779980007,0.0009714928283514,0.0051425164454662,0.0066187936545288,0.0369610086162669,0.0437035325872115,0.0499529601882759,0.0560177758282803,0.0000082197047243,0.0000331802565443,0.0001820527370220,0.0006151031541677,0.0034750256886520,0.0044669766375725,0.0267405786864733,0.0306748439006735,0.0340392259070113,0.0427883900942434,0.0000032491487389,0.0000131559385363,0.0000867173468739,0.0003611308294702,0.0021998653619106,0.0027364649336412,0.0169345258250543,0.0181377904041176,0.0196047097081265,0.0273975355424407,0.0000013917992210,0.0000046508548595,0.0000312260609876,0.0001654925872379,0.0011510983748756,0.0012826548505672,0.0075666000792805,0.0077669146405568,0.0081325248850271,0.0126781828877133,0.0000033361112353,0.0000124379125153,0.0000552083274683,0.0001435245397662,0.0005102960703768,0.0005907063581637,-0.0021431702809256,-0.0024819207365809,-0.0030767446711672,-0.0006481563580984,0.0000013755771745,0.0000055676087093,0.0000310616307475,0.0001015213131246,0.0004827429760893,0.0005854579881320,0.0000782312155228,-0.0009266727062976,-0.0031938985271057,-0.0097120420690991,0.0000004973807083,0.0000021034010596,0.0000148124828286,0.0000628881401626,0.0003667038025719,0.0004446722738652,0.0011897822476534,-0.0000499669571416,-0.0024272160406103,-0.0105041663162995,0.0000001847476884,0.0000006725505495,0.0000052020020281,0.0000294704655237,0.0002092928544359,0.0002305914158237,0.0008854970402895,0.0001225599855482,-0.0011736831511556,-0.0062242421835029,0.0000050029095730,0.0000191139417028,0.0000945573706451,0.0002988253968899,0.0016710587514898,0.0021363062293475,0.0109363936678317,0.0139716600751902,0.0186940135309796,0.0366464666430905,0.0000019277600703,0.0000079821960619,0.0000483522909064,0.0001807930753602,0.0011464959550547,0.0014813884912202,0.0082718707123205,0.0099145879995294,0.0117969887551607,0.0193945551638575,0.0000006397559267,0.0000028073175539,0.0000213278678434,0.0000996507052947,0.0007205646673288,0.0009312473111891,0.0062268153487571,0.0064583833519306,0.0062686768965322,0.0067571759558620,0.0000002133994157,0.0000008218460628,0.0000070283270942,0.0000433314703317,0.0003642228711416,0.0004397987449912,0.0035487840003292,0.0031736121563601,0.0023791688617511,0.0002184945361345,};
	d_fgm b_upper[40] = {0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,0.2000000000000000,};
	d_fgm b_lower[40] = {-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,-0.1997000000000000,};
	d_fgm beta_var = 0.9131153994934530;
	d_fgm beta_plus = 1.9131153994934529;

	d_fgm Z_new[n_opt_var],Z[n_opt_var];
	d_fgm Y_new[n_opt_var], Y[n_opt_var];
	d_fgm h[n_opt_var];
	d_fgm T[n_opt_var];

	d_fgm iter_error;

	reset_grad: for(i = 0; i < n_opt_var; i++) 
	{
		#pragma HLS PIPELINE
		h[i] = 0;
	}
	grad: for(j = 0; j < n_states; j++)
	{
		grad_1: for(i = 0; i < n_opt_var; i++) 
		{
			#pragma HLS LOOP_FLATTEN
			#pragma HLS PIPELINE
			h[i] += x_hat[j] * h_x[j][i];
		}
	}

	guess_initialization: for(i = 0; i < n_opt_var; i++)
	{
		#pragma HLS PIPELINE
		Z[i] = 0;
		Y[i] = 0;
	}

	iteration_loop: for(k = 0; k < n_iter; k++)
	{
		reset_output:for(i = 0; i < n_opt_var; i++)
		{
			#pragma HLS PIPELINE
			T[i] = 0;
		}

		mv_mult:for(j = 0; j < n_opt_var; j++)
		{
			vv_mult: for(i = 0; i < n_opt_var; i++)
			{
				#pragma HLS LOOP_FLATTEN
				#pragma HLS PIPELINE
				T[i] += -H_diff_negative[i][j] * Y[j];
			}
		}

		subtract_gradient:for(i = 0; i < n_opt_var; i++)
		{
			#pragma HLS PIPELINE
			T[i] = T[i] - h[i];
		}

		projection_loop: for(i = 0; i < n_opt_var; i++)
		{
			#pragma HLS PIPELINE
			if(T[i] > b_upper[i])
			{
				Z_new[i] = b_upper[i];
			}
			else if (T[i] < b_lower[i])
			{
				Z_new[i] = b_lower[i];
			}
			else
			{
				Z_new[i] = T[i];
			}
		}

		fgm_step:for(i = 0; i < n_opt_var; i++)
		{
			#pragma HLS PIPELINE
			Y_new[i] = beta_plus * Z_new[i] - beta_var * Z[i];		
		}

		//iter_error = 0;
		update_loop: for(i=0; i < n_opt_var; i++)
		{
			#pragma HLS PIPELINE
			//iter_error += fabs(Y[i] - Y_new[i]);
			Z[i] = Z_new[i];
			Y[i] = Y_new[i];
		}
		//printf("error[%d] = %f \n",k,iter_error);
	}

	output_loop: for(i=0; i < n_opt_var; i++)
	{
		#pragma HLS PIPELINE
		u_opt[i] = Y_new[i];
	}
}
